const APP_ID = '1978aa02f3f546cf90eba22fc1566d64';
const API_URL = `https://openexchangerates.org/api`;

export interface CurrencyRatesMap {
  [prop: string]: number
}

export interface CurrencyRates {
  timestamp: number;
  base: string;
  rates: CurrencyRatesMap
}

export interface CurrenciesMap {
  [prop: string]: string;
}

const stubRates = {
  "disclaimer": "Usage subject to terms: https://openexchangerates.org/terms",
  "license": "https://openexchangerates.org/license",
  "timestamp": 1622041200,
  "base": "USD",
  "rates": {
    "AED": 3.6732,
    "AFN": 78.750002,
    "ALL": 100.45,
    "AMD": 520.828816,
    "ANG": 1.796011,
    "AOA": 643.121,
    "ARS": 94.4859,
    "AUD": 1.292165,
    "AWG": 1.79975,
    "AZN": 1.700805,
    "BAM": 1.598991,
    "BBD": 2,
    "BDT": 84.746734,
    "BGN": 1.5999,
    "BHD": 0.377028,
    "BIF": 1971.5,
    "BMD": 1,
    "BND": 1.323517,
    "BOB": 6.898799,
    "BRL": 5.3067,
    "BSD": 1,
    "BTC": 0.000025483775,
    "BTN": 72.735106,
    "BWP": 10.632994,
    "BYN": 2.511681,
    "BZD": 2.016809,
    "CAD": 1.211492,
    "CDF": 2004,
    "CHF": 0.896357,
    "CLF": 0.026597,
    "CLP": 733.9,
    "CNH": 6.384498,
    "CNY": 6.3903,
    "COP": 3742.64,
    "CRC": 618.384949,
    "CUC": 1,
    "CUP": 25.75,
    "CVE": 90.45,
    "CZK": 20.813307,
    "DJF": 178,
    "DKK": 6.086572,
    "DOP": 57,
    "DZD": 133.313434,
    "EGP": 15.6816,
    "ERN": 15.001997,
    "ETB": 43.005879,
    "EUR": 0.818516,
    "FJD": 2.0297,
    "FKP": 0.707968,
    "GBP": 0.707968,
    "GEL": 3.285,
    "GGP": 0.707968,
    "GHS": 5.785,
    "GIP": 0.707968,
    "GMD": 51.2,
    "GNF": 9865,
    "GTQ": 7.724287,
    "GYD": 209.327432,
    "HKD": 7.761355,
    "HNL": 24.11,
    "HRK": 6.1495,
    "HTG": 90.409647,
    "HUF": 286.348387,
    "IDR": 14294.35,
    "ILS": 3.247254,
    "IMP": 0.707968,
    "INR": 72.717862,
    "IQD": 1462.5,
    "IRR": 42105,
    "ISK": 121.23,
    "JEP": 0.707968,
    "JMD": 149.307278,
    "JOD": 0.709,
    "JPY": 109.04503571,
    "KES": 107.6,
    "KGS": 83.9948,
    "KHR": 4080,
    "KMF": 402.249941,
    "KPW": 900,
    "KRW": 1117.363362,
    "KWD": 0.300685,
    "KYD": 0.833827,
    "KZT": 428.339851,
    "LAK": 9440,
    "LBP": 1519.572912,
    "LKR": 198.606366,
    "LRD": 171.649978,
    "LSL": 13.86,
    "LYD": 4.445,
    "MAD": 8.8225,
    "MDL": 17.611927,
    "MGA": 3761.530474,
    "MKD": 50.32563,
    "MMK": 1646.872348,
    "MNT": 2850.956548,
    "MOP": 7.999379,
    "MRO": 356.999828,
    "MRU": 36.13,
    "MUR": 40.4,
    "MVR": 15.4,
    "MWK": 797.930015,
    "MXN": 19.872802,
    "MYR": 4.1425,
    "MZN": 60.200005,
    "NAD": 13.86,
    "NGN": 412.5,
    "NIO": 35.3,
    "NOK": 8.345429,
    "NPR": 116.374199,
    "NZD": 1.372625,
    "OMR": 0.384983,
    "PAB": 1,
    "PEN": 3.824,
    "PGK": 3.535,
    "PHP": 48.133333,
    "PKR": 154.3,
    "PLN": 3.678744,
    "PYG": 6719.179214,
    "QAR": 3.641,
    "RON": 4.026,
    "RSD": 96.14772,
    "RUB": 73.594125,
    "RWF": 1002.316264,
    "SAR": 3.750225,
    "SBD": 7.964986,
    "SCR": 16.499611,
    "SDG": 412.5,
    "SEK": 8.308352,
    "SGD": 1.324664,
    "SHP": 0.707968,
    "SLL": 10239.99996,
    "SOS": 585,
    "SRD": 14.154,
    "SSP": 130.26,
    "STD": 20736.892254,
    "STN": 20.275,
    "SVC": 8.75512,
    "SYP": 1257.615089,
    "SZL": 13.86,
    "THB": 31.235,
    "TJS": 11.411216,
    "TMT": 3.5,
    "TND": 2.7205,
    "TOP": 2.24795,
    "TRY": 8.44648,
    "TTD": 6.804125,
    "TWD": 27.799001,
    "TZS": 2319,
    "UAH": 27.471661,
    "UGX": 3549.876818,
    "USD": 1,
    "UYU": 43.961786,
    "UZS": 10585,
    "VES": 3030303.030303,
    "VND": 23096.679966,
    "VUV": 108.218608,
    "WST": 2.51332,
    "XAF": 536.911169,
    "XAG": 0.03598352,
    "XAU": 0.00052612,
    "XCD": 2.70255,
    "XDR": 0.692105,
    "XOF": 536.911169,
    "XPD": 0.00036266,
    "XPF": 97.674917,
    "XPT": 0.00083439,
    "YER": 250.000125,
    "ZAR": 13.792338,
    "ZMW": 22.50464,
    "ZWL": 322
  }
};

const stubCurrencies = {
  "AED": "United Arab Emirates Dirham",
  "AFN": "Afghan Afghani",
  "ALL": "Albanian Lek",
  "AMD": "Armenian Dram",
  "ANG": "Netherlands Antillean Guilder",
  "AOA": "Angolan Kwanza",
  "ARS": "Argentine Peso",
  "AUD": "Australian Dollar",
  "AWG": "Aruban Florin",
  "AZN": "Azerbaijani Manat",
  "BAM": "Bosnia-Herzegovina Convertible Mark",
  "BBD": "Barbadian Dollar",
  "BDT": "Bangladeshi Taka",
  "BGN": "Bulgarian Lev",
  "BHD": "Bahraini Dinar",
  "BIF": "Burundian Franc",
  "BMD": "Bermudan Dollar",
  "BND": "Brunei Dollar",
  "BOB": "Bolivian Boliviano",
  "BRL": "Brazilian Real",
  "BSD": "Bahamian Dollar",
  "BTC": "Bitcoin",
  "BTN": "Bhutanese Ngultrum",
  "BWP": "Botswanan Pula",
  "BYN": "Belarusian Ruble",
  "BZD": "Belize Dollar",
  "CAD": "Canadian Dollar",
  "CDF": "Congolese Franc",
  "CHF": "Swiss Franc",
  "CLF": "Chilean Unit of Account (UF)",
  "CLP": "Chilean Peso",
  "CNH": "Chinese Yuan (Offshore)",
  "CNY": "Chinese Yuan",
  "COP": "Colombian Peso",
  "CRC": "Costa Rican Colón",
  "CUC": "Cuban Convertible Peso",
  "CUP": "Cuban Peso",
  "CVE": "Cape Verdean Escudo",
  "CZK": "Czech Republic Koruna",
  "DJF": "Djiboutian Franc",
  "DKK": "Danish Krone",
  "DOP": "Dominican Peso",
  "DZD": "Algerian Dinar",
  "EGP": "Egyptian Pound",
  "ERN": "Eritrean Nakfa",
  "ETB": "Ethiopian Birr",
  "EUR": "Euro",
  "FJD": "Fijian Dollar",
  "FKP": "Falkland Islands Pound",
  "GBP": "British Pound Sterling",
  "GEL": "Georgian Lari",
  "GGP": "Guernsey Pound",
  "GHS": "Ghanaian Cedi",
  "GIP": "Gibraltar Pound",
  "GMD": "Gambian Dalasi",
  "GNF": "Guinean Franc",
  "GTQ": "Guatemalan Quetzal",
  "GYD": "Guyanaese Dollar",
  "HKD": "Hong Kong Dollar",
  "HNL": "Honduran Lempira",
  "HRK": "Croatian Kuna",
  "HTG": "Haitian Gourde",
  "HUF": "Hungarian Forint",
  "IDR": "Indonesian Rupiah",
  "ILS": "Israeli New Sheqel",
  "IMP": "Manx pound",
  "INR": "Indian Rupee",
  "IQD": "Iraqi Dinar",
  "IRR": "Iranian Rial",
  "ISK": "Icelandic Króna",
  "JEP": "Jersey Pound",
  "JMD": "Jamaican Dollar",
  "JOD": "Jordanian Dinar",
  "JPY": "Japanese Yen",
  "KES": "Kenyan Shilling",
  "KGS": "Kyrgystani Som",
  "KHR": "Cambodian Riel",
  "KMF": "Comorian Franc",
  "KPW": "North Korean Won",
  "KRW": "South Korean Won",
  "KWD": "Kuwaiti Dinar",
  "KYD": "Cayman Islands Dollar",
  "KZT": "Kazakhstani Tenge",
  "LAK": "Laotian Kip",
  "LBP": "Lebanese Pound",
  "LKR": "Sri Lankan Rupee",
  "LRD": "Liberian Dollar",
  "LSL": "Lesotho Loti",
  "LYD": "Libyan Dinar",
  "MAD": "Moroccan Dirham",
  "MDL": "Moldovan Leu",
  "MGA": "Malagasy Ariary",
  "MKD": "Macedonian Denar",
  "MMK": "Myanma Kyat",
  "MNT": "Mongolian Tugrik",
  "MOP": "Macanese Pataca",
  "MRO": "Mauritanian Ouguiya (pre-2018)",
  "MRU": "Mauritanian Ouguiya",
  "MUR": "Mauritian Rupee",
  "MVR": "Maldivian Rufiyaa",
  "MWK": "Malawian Kwacha",
  "MXN": "Mexican Peso",
  "MYR": "Malaysian Ringgit",
  "MZN": "Mozambican Metical",
  "NAD": "Namibian Dollar",
  "NGN": "Nigerian Naira",
  "NIO": "Nicaraguan Córdoba",
  "NOK": "Norwegian Krone",
  "NPR": "Nepalese Rupee",
  "NZD": "New Zealand Dollar",
  "OMR": "Omani Rial",
  "PAB": "Panamanian Balboa",
  "PEN": "Peruvian Nuevo Sol",
  "PGK": "Papua New Guinean Kina",
  "PHP": "Philippine Peso",
  "PKR": "Pakistani Rupee",
  "PLN": "Polish Zloty",
  "PYG": "Paraguayan Guarani",
  "QAR": "Qatari Rial",
  "RON": "Romanian Leu",
  "RSD": "Serbian Dinar",
  "RUB": "Russian Ruble",
  "RWF": "Rwandan Franc",
  "SAR": "Saudi Riyal",
  "SBD": "Solomon Islands Dollar",
  "SCR": "Seychellois Rupee",
  "SDG": "Sudanese Pound",
  "SEK": "Swedish Krona",
  "SGD": "Singapore Dollar",
  "SHP": "Saint Helena Pound",
  "SLL": "Sierra Leonean Leone",
  "SOS": "Somali Shilling",
  "SRD": "Surinamese Dollar",
  "SSP": "South Sudanese Pound",
  "STD": "São Tomé and Príncipe Dobra (pre-2018)",
  "STN": "São Tomé and Príncipe Dobra",
  "SVC": "Salvadoran Colón",
  "SYP": "Syrian Pound",
  "SZL": "Swazi Lilangeni",
  "THB": "Thai Baht",
  "TJS": "Tajikistani Somoni",
  "TMT": "Turkmenistani Manat",
  "TND": "Tunisian Dinar",
  "TOP": "Tongan Pa'anga",
  "TRY": "Turkish Lira",
  "TTD": "Trinidad and Tobago Dollar",
  "TWD": "New Taiwan Dollar",
  "TZS": "Tanzanian Shilling",
  "UAH": "Ukrainian Hryvnia",
  "UGX": "Ugandan Shilling",
  "USD": "United States Dollar",
  "UYU": "Uruguayan Peso",
  "UZS": "Uzbekistan Som",
  "VEF": "Venezuelan Bolívar Fuerte (Old)",
  "VES": "Venezuelan Bolívar Soberano",
  "VND": "Vietnamese Dong",
  "VUV": "Vanuatu Vatu",
  "WST": "Samoan Tala",
  "XAF": "CFA Franc BEAC",
  "XAG": "Silver Ounce",
  "XAU": "Gold Ounce",
  "XCD": "East Caribbean Dollar",
  "XDR": "Special Drawing Rights",
  "XOF": "CFA Franc BCEAO",
  "XPD": "Palladium Ounce",
  "XPF": "CFP Franc",
  "XPT": "Platinum Ounce",
  "YER": "Yemeni Rial",
  "ZAR": "South African Rand",
  "ZMW": "Zambian Kwacha",
  "ZWL": "Zimbabwean Dollar"
};

export class CurrencyRatesProvider {
  static useMocked = false;

  static async getRates(): Promise<CurrencyRates> {
    if (CurrencyRatesProvider.useMocked) {
      return stubRates as CurrencyRates;
    }
    const response = await fetch(`${API_URL}/latest.json?app_id=${APP_ID}`)
    const rates = await response.json();
    return rates as CurrencyRates
  }

  static async getCurrencies(): Promise<CurrenciesMap> {
    if (CurrencyRatesProvider.useMocked) {
      return stubCurrencies as CurrenciesMap;
    }
    const response = await fetch(`${API_URL}/latest.json?app_id=${APP_ID}`)
    const currencies = await response.json();
    return currencies as CurrenciesMap
  }
}